(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){e.exports=a(36)},23:function(e,t,a){},24:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},25:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(6),r=a.n(i),o=(a(23),a(7)),l=a(11),c=a(12),u=a(14),h=a(13),m=a(16),d=(a(24),a(25),a(2)),p=a.n(d),g=a(3),f=new(a(15).a),b=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e)))._handleKeyDown=function(e){switch(e.keyCode){case 32:a.setState(function(e,t){return{bo:e.bo-.5}}),a.populateCanvas();break;case 37:case 38:case 39:case 40:console.log(a.timer),a.timer.current.start(),a.side==e.keyCode?(a.beep(100,520,200),a.before?(a.before=!1,a.setState(function(e,t){return{bo:e.bo+.5,max:Math.max(e.bo+.5,e.max)}})):a.before=!0):(a.beep(100,220,200),a.before?a.before=!1:(a.before=!0,a.setState(function(e,t){return{bo:e.bo-.5}}))),a.populateCanvas();break;case 67:a.setState({configurationOpen:!0});break;case 73:a.setState({instructionsOpen:!0});break;case 80:a.setState({progressOpen:!0})}},a.handleInputChange=function(e){a.setState(Object(o.a)({},e.target.name,Number(e.target.value))),a.populateCanvas()},a.updateTime=function(e){a.setState(Object(o.a)({},e.target.name,Number(e.target.value))),a.timer.current.setTime(6e4*Number(e.target.value)),a.timer.current.start(),a.timer.current.stop(),a.populateCanvas()},a.updateWindowWidth=function(e){a.windowWidth=Number(e.target.value),a.ppcm=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)/a.windowWidth,console.log(a.ppcm*a.distance/100),a.setState({delta:Math.round(a.ppcm*a.distance/100)})},a.updateDistance=function(e){a.distance=Number(e.target.value),a.setState({delta:Math.round(a.ppcm*a.distance/100)})},a.state={delta:a.getCookie("delta")||22,bo:0,max:0,instructionsOpen:!0,configurationOpen:!1,progressOpen:!1,distance:a.getCookie("distance")||40,height:a.getCookie("height")||500,smallLength:a.getCookie("smallLength")||100,shift:a.getCookie("shift")||16,time:a.getCookie("time")||10},a.windowWidth=a.getCookie("windowWidth")||30,a.distance=a.getCookie("distance")||40,a.ppcm=a.getCookie("ppcm")||56,a.side=0,a.before=!1,a.ac=new AudioContext,a.timer=s.a.createRef(),a.progress=f.get("progress")||"{}",a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getCookie",value:function(e){return Number(f.get(e))}},{key:"persistCookies",value:function(){f.set("delta",this.state.delta),f.set("distance",this.state.distance),f.set("height",this.state.height),f.set("smallLength",this.state.smallLength),f.set("shift",this.state.shift),f.set("time",this.state.time),f.set("windowWidth",this.windowWidth),f.set("distance",this.distance),f.set("ppcm",this.ppcm)}},{key:"componentDidMount",value:function(){document.title="Convergence Insufficiency Trainer",document.addEventListener("keydown",this._handleKeyDown),this.populateCanvas()}},{key:"beep",value:function(e,t,a){var n=this.ac.createOscillator(),s=this.ac.createGain();n.connect(s),n.frequency.value=t,n.type="square",s.connect(this.ac.destination),s.gain.value=.01*e,n.start(this.ac.currentTime),n.stop(this.ac.currentTime+.001*a)}},{key:"populateCanvas",value:function(){this.state.bo<0&&this.setState(function(e,t){return{bo:0}});var e=this.refs.canvas,t=e.getContext("2d"),a=Math.round(this.state.bo*this.state.delta),n=this.state.height+a;e.width=n,e.height=this.state.height;var s=t.createImageData(n,this.state.height);this.side=Math.floor(4*Math.random())+37;var i=this.state.height/10,r=this.state.height/2-this.state.smallLength/2;switch(this.side){case 37:this.buildStereograms(s.data,n,a,i,r);break;case 38:this.buildStereograms(s.data,n,a,r,i);break;case 39:this.buildStereograms(s.data,n,a,this.state.height-this.state.smallLength-i,r);break;case 40:this.buildStereograms(s.data,n,a,r,this.state.height-this.state.smallLength-i)}t.putImageData(s,0,0)}},{key:"buildStereograms",value:function(e,t,a,n,s){for(var i=0;i<e.length;i+=4){var r=i/4%t,o=Math.floor(i/4/t),l=(t-a)/2;e[i]=r<t-a?l-7<r&&r<l+7&&l-7<o&&o<l+7?255:l-10<r&&r<l+10&&l-10<o&&o<l+10?0:255*Math.round(Math.random()):0,r<a?e[i+2]=0:r>n+a&&r<n+this.state.smallLength+a&&o>s&&o<s+this.state.smallLength?e[i+2]=e[i-4*a-4*this.state.shift]:e[i+2]=e[i-4*a],e[i+1]=0,e[i+3]=255}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},s.a.createElement("canvas",{ref:"canvas",width:"1000",height:"500"}),s.a.createElement("br",null),s.a.createElement("div",null,s.a.createElement("font",{color:"white"},"BO ",this.state.bo," MAX ",this.state.max," TIME",s.a.createElement(g.a,{ref:this.timer,initialTime:6e4*this.state.time,direction:"backward",startImmediately:!1,checkpoints:[{time:0,callback:function(){e.beep(100,300,1e3);var t=(new Date).toISOString().slice(0,10);t in e.progress&&!(e.state.max>e.progress[t])||(e.progress[t]=e.state.max,f.set("progress",JSON.stringify(e.progress)))}}]},function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(g.a.Minutes,null)," m ",s.a.createElement(g.a.Seconds,null)," s")}),s.a.createElement("br",null),s.a.createElement("i",null,"[i]nstructions, [c]onfiguration, [p]rogress"))),s.a.createElement(p.a,{isOpen:this.state.instructionsOpen,onRequestClose:function(){e.setState({instructionsOpen:!1})},contentLabel:"Instructions"},"INSTRUCTIONS"),s.a.createElement(p.a,{isOpen:this.state.progressOpen,onRequestClose:function(){e.setState({progressOpen:!1})},contentLabel:"Progress"},"PROGRESS ",s.a.createElement("br",null),JSON.stringify(this.progress)),s.a.createElement(p.a,{isOpen:this.state.configurationOpen,onRequestClose:function(){e.persistCookies(),e.setState({configurationOpen:!1})},contentLabel:"Configuration"},"CONFIGURATION ",s.a.createElement("br",null),s.a.createElement("form",null,s.a.createElement("label",null,"Width of window (cm):",s.a.createElement("input",{name:"windowWidth",type:"number",defaultValue:this.windowWidth,onBlur:this.updateWindowWidth})),s.a.createElement("br",null),s.a.createElement("label",null,"Distance to screen (cm):",s.a.createElement("input",{name:"distance",type:"number",defaultValue:this.distance,onBlur:this.updateDistance})),s.a.createElement("br",null),s.a.createElement("label",null,"Height of square (px):",s.a.createElement("input",{name:"height",type:"number",defaultValue:this.state.height,onBlur:this.handleInputChange})),s.a.createElement("br",null),s.a.createElement("label",null,"Height of offset square (px):",s.a.createElement("input",{name:"smallLength",type:"number",defaultValue:this.state.smallLength,onBlur:this.handleInputChange})),s.a.createElement("br",null),s.a.createElement("label",null,"Shift of offset square (px):",s.a.createElement("input",{name:"shift",type:"number",defaultValue:this.state.shift,onBlur:this.handleInputChange})),s.a.createElement("br",null),s.a.createElement("label",null,"Time per session (minutes):",s.a.createElement("input",{name:"time",type:"number",defaultValue:this.state.time,onBlur:this.updateTime})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.4cfef8a1.chunk.js.map